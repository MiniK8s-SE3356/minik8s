# MiniK8s 开发规约

## 分支命名规则
- **main**：主分支，也是最后的发布分支，此分支的任何变动都将引发全面的CI/CD检查，以确保分支上无重大问题
- **development/\<function\>/...**：开发分支，当多个feature需要合并，但不确定能否合并入main时，可以在该类分支上合并
  - function：对当前开发功能的简单称谓，不要太长，可以存在多级
  > ex. `development/apiserver`, `development/apiobject/kubelet`
- **feature/\<function\>/.../\<developer\>**:功能分支，完成具体功能点的实际工作分支，大部分功能或特性应该都在此类分支上完成，并逐步合并进入development和main分支
  - function: 对当前开发功能的简单称谓，不要太长，可以存在多级
  - developer: 开发者姓名简写，必须置于分支名层级的最后一层
  > ex. `feature/apiserver/whc`, `feature/apiobject/kube-proxy/dyh`
- **其他格式**：一些受归约保护的临时性分支

## 分支保护
- 向main分支提交pull request时，需要两位collaborator的approval才能允许merge，以减少为主发布分支引入未达成共识的修改  
  > p.s. 由于github organization中，启用分支保护为付费项目，我们目前只能采取人工遵守归约的方式

## 代码格式化
go提供工具gofmt，使用方式可参考以下内容，格式配置默认即可：    
`https://go.dev/blog/gofmt`   
`https://stackoverflow.com/questions/13319165/go-fmt-on-a-whole-source-tree`   
开发人员应该在commit前应该主动执行code format

## CI/CD
使用`github action`,以及go的原生测试框架`go text`为CI/CD方案的核心技术，必要时编写脚本文件细化测试

## 模块依赖
采取最简单的go依赖配置：整个MiniK8s工程在根目录init为一个module,工程内部各目录对应同一个module下的不同package  
一个package的范围为**该目录及其直接子文件（该目录的子目录下文件属于子目录package）**   
为了使不同的package易于查找定位，**除了main 和 test package以外，其他源文件的package名必须与其直接父目录名一致**  
